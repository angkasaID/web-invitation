import{d}from"./firebase.Cce6toix.js";window.showSuccessToast=function(){const n=document.getElementById("success-toast");n&&(n.classList.remove("hidden"),requestAnimationFrame(()=>{n.classList.remove("translate-x-full")}),setTimeout(()=>{n.classList.add("translate-x-full"),setTimeout(()=>n.classList.add("hidden"),300)},3e3))};let y=[],b=6;document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("send-rsvp-btn-modal"),a=document.getElementById("rsvp-messages"),i=document.getElementById("rsvp-name-modal"),l=document.getElementById("load-more-btn"),c=document.getElementById("rsvp-greeting-name"),u=document.getElementById("rsvp-status-modal"),v=document.getElementById("rsvp-message-modal"),p=window.getGuestNameFromUrl?window.getGuestNameFromUrl():"Tamu";c&&(c.textContent=p),i&&(i.value=p.replace(/\+/g," ")),n&&n.addEventListener("click",()=>{const o=i.value.trim()||"Tamu Undangan",e=u.value,s=v.value;d.ref("rsvp").push({name:o,status:e,count:1,message:s,timestamp:Date.now()}),window.showSuccessToast(),u.value="Hadir",v.value=""});function g(){if(!a)return;a.innerHTML="",y.slice().reverse().slice(0,b).forEach(e=>{const s=e.status==="Hadir",t=document.createElement("div");t.className=`flex items-end mb-3 ${s?"justify-start":"justify-end"} opacity-0 translate-y-3`;const r=document.createElement("div");r.innerText=e.name.charAt(0).toUpperCase(),r.className="w-8 h-8 rounded-full flex items-center justify-center text-white font-semibold bg-gray-400 shadow";const w=new Date(e.timestamp),h=w.getHours().toString().padStart(2,"0"),x=w.getMinutes().toString().padStart(2,"0"),m=document.createElement("div");m.className=`
          px-4 py-2 rounded-lg shadow max-w-[75%] break-words
          ${s?"bg-lime-100 rounded-bl-none":"bg-red-100 rounded-br-none"}
        `,m.innerHTML=`
          <div class="text-xs text-gray-500 font-semibold mb-1">${e.name} â€¢ ${h}:${x}</div>
          <div class="text-sm mb-1">${e.message||"<i>Tidak ada pesan</i>"}</div>
          <div class="text-xs text-gray-600">Status: ${e.status}</div>
        `,s?t.append(r,m):t.append(m,r),a.append(t),requestAnimationFrame(()=>{t.style.transition="all 0.25s ease",t.style.opacity=1,t.style.transform="translateY(0)"})}),a.scrollTop=a.scrollHeight}a&&d.ref("rsvp").orderByChild("timestamp").on("value",o=>{const e=o.val()||{};y=Object.values(e).sort((s,t)=>s.timestamp-t.timestamp),g()}),l&&l.addEventListener("click",()=>{b+=6,g()});function f(){const o=Date.now();d.ref("rsvp").once("value",e=>{const s=e.val()||{};Object.entries(s).forEach(([t,r])=>{o-r.timestamp>1440*60*1e3&&d.ref("rsvp/"+t).remove()})})}f(),setInterval(f,3600*1e3)});
